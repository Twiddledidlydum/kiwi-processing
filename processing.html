<!DOCTYPE html>
<html>

<head>
  <script src="javascript/jquery-2.0.3.js"></script>
  <script src="javascript/socket.io.js"></script>
  <script src="javascript/processing.js"></script>
</head>

<body>

<script id="script" type="text/javascript">

 var kiwisocket = io.connect('http://build.kiwiwearables.com:8080');

 var toParse = null;
 var Ax = 0;
 var Ay = 0;
 var Az = 0;
 var Gx = 0;
 var Gy = 0;
 var Gz = 0;

// Enter your device id and password here

kiwisocket.on('connect', function() {
  kiwisocket.emit('listen', {device_id: '42', password: '123'});
});

kiwisocket.on('listen_response', function(data) {

  //console.log(data);

  toParse = JSON.parse(data.message);

  Ax = parseFloat(toParse.ax);
  Ay = parseFloat(toParse.ay);
  Az = parseFloat(toParse.az);  

  Gx = parseFloat(toParse.gx);
  Gy = parseFloat(toParse.gy);
  Gz = parseFloat(toParse.gz);

});

</script>

<script type="text/processing" data-processing-target="mycanvas">

float radius = 50.0;
int X, Y;
int nX, nY;
int delay = 2;

void setup() {

    size( 1400, 800 );
    strokeWeight( 10 );
    frameRate( 15 );
    X = 700;
    Y = 400;

}

void draw(){  

    radius = radius + sin( frameCount / 4 );

    // Track circle to new destination
    X+=Ax*16;
    Y+=Ay*16;

    if(X <= 0) {
      X = X*-1
    }
    if(X >= 800) {
      X = X-800
    }
    if(Y <= 0) {
      Y = Y*-1
    }
    if(X >= 1400) {
      Y = Y-1400
    }


    console.log(X);
    //console.log(nX);

    // Fill canvas grey
    background( 100 );

    // Set fill-color to blue
    fill( 0, 121, 184 );

    // Set stroke-color white
    stroke(255); 

    // Draw circle
    ellipse( X, Y, radius, radius ); 

}
</script>
<canvas id="mycanvas"></canvas>
</body>
</html>